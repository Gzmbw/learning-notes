%-*- coding: UTF-8 -*-
% Specialities.tex
%
\documentclass[UTF8]{ctexart}
\usepackage{geometry}
\geometry{a4paper, centering, scale=0.8}
\usepackage{minted}
\usepackage{float}

\title{\heiti 第4章 \quad 特色功能}
\author{\kaishu Du Ang \\ \texttt{du2ang233@gmail.com} }
\date{\today}


\begin{document}
\maketitle

\tableofcontents

\newpage

在编写大型文档的时候，\LaTeX 还提供了一些像创建索引、管理参考文献等一些特色功能，详情见 \emph{\LaTeX Manual} 和
\emph{The \LaTeX Companion}。

\section{包含 Encapsulated PostScript}
借助 \texttt{figure} 和 \texttt{table} 环境，\LaTeX 能够支持一些像图像、图形这种简单的浮动体。

在基本的 \LaTeX 中或 \LaTeX 的扩展包中，有很多种方法能够生成一些实际的图形。一种比较简单的方法是，通过一些专业软件生
成这些图形，然后将它们包含到文档中。这里我们仅讨论使用 Encapsulated PostScript（EPS）来生
成图形，因为这种方法非常简单，而且获得了广泛的应用。为了使用 EPS 格式的图片，必须要有 PostScript 打印机来输出。

D. P. Carlisle 开发的 \texttt{graphicx} 宏包提供了很多包含图片的命令，这个宏包属于“graphics”宏集。

假设现在的系统有可以输出 PostScript 打印机，也安装好了 \texttt{graphicx} 宏包，可以根据下面的步骤在文档中包含图
片：
\begin{enumerate}
    \item 通过画图程序输出 EPS 格式的图片。
    \item 通过 \mintinline{LaTeX}|\usepackage[driver]{graphicx}| 命令，在导言区引入 \texttt{graphicx}
    宏包。 \\
    其中 \emph{driver} 是 dvi 转 PostScript 的转换程序，最常用的一种叫 \texttt{dvips}。知道
    \emph{driver} 的名字后，\texttt{graphicx} 宏包就可以选择正确的方法来将图形信息插入到 \texttt{.dvi} 文件
    中，然后打印机就能理解它并且正确地包含 \texttt{.eps} 文件。
    \item 在文档中使用 \mintinline{LaTeX}|\includegraphics[key=value, ...]{file}| 来包含 \emph{file}。
    \\ 命令中的可选参数允许有多个，之间用逗号隔开。\emph{key} 可以是 \texttt{width}、\texttt{height}、
    \texttt{angle}、\texttt{scale} 等参数，用于对包含的图形进行调整。
\end{enumerate}

示例代码：
\begin{minted}{LaTeX}
    \begin{figure}
        \centering
        \includegraphics[angle=90, width=0.5\textwidth]{test}
        \caption{This is a test.}
    \end{figure}
\end{minted}

上面的代码包含了存储好的 \texttt{test.eps} 图片。图片旋转了90度，并且图片的宽度缩放到了标准图片的0.5倍。由于没有
指定高度，所以默认宽高比是1。宽度和高度也可以指定为具体的长度。

\section{参考文献（Bibliography）}
通过 \texttt{thebibliography} 环境来生成参考文献。每一个条目都以 \mintinline{LaTeX}|\bibitem[lable]{marker}|
开头，再通过 \mintinline{LaTeX}|\cite{marker}| 命令，就可以用来在文档中引用书籍、文章、论文等。

如果不指定 \emph{label} 参数，所有的参考文献条目会自动编号。\mintinline{LaTeX}|\begin{thebibliography}| 命令
后的参数用来定义应该为条目编号预留多少空隙。在下面的示例中，该参数为 \texttt{\{99\}}，表示所有的参考文献条目编号都不
能比数字99更宽。

示例代码：
\begin{minted}{LaTeX}
    Partl~\cite{pa} has proposed that \ldots
    \begin{thebibliography}{99}
    \bibitem{pa} H.~Partl: \emph{German \TeX}, TUGboat Volume~9, Issue~1 (1988)
    \end{thebibliography}
\end{minted}

示例输出：
Partl~\cite{pa} has proposed that \ldots
\begin{thebibliography}{99}
\bibitem{pa} H.~Partl: \emph{German \TeX}, TUGboat Volume~9, Issue~1 (1988)
\end{thebibliography}

对于更大型的项目，使用 Bib\TeX 是更好的选择。可以利用 Bib\TeX 建立一个参考文献数据库，然后再在文档中引用相关的文献。
Bib\TeX 产生的参考文献格式是通过样式文件定义的，网上有很多现成的样式文件可供选择。

\section{索引（Indexing）}
索引是一个非常有用的功能，在很多书中都能看到它。\LaTeX 中有个 \texttt{makeindex} 程序，可以方便地建立索引。这里仅
介绍基本的索引生成命令，更多内容见 \emph{The \LaTeX Companion}。

为了建立索引，需要在导言区通过 \mintinline{LaTeX}|\usepackage{makeindex}| 命令来引入 \texttt{makeidx} 宏
包，然后再在导言区中加入 \mintinline{LaTeX}{\makeindex} 命令来开启这项功能。

在正文中需要建立索引的地方，通过 \mintinline{LaTeX}|\index{key@formatted_entry}| 命令添加索引项。
可选参数 \emph{formatted\_entry} 会出现在建立索引的地方；参数 \emph{key} 用来排序。表~\ref{tab:index}
是索引项的写法示例。

\begin{table}[H]
\caption{索引项写法示例}
\label{tab:index}
\begin{center}
\begin{tabular}{@{}lll@{}}
  \textbf{Example} &\textbf{Index Entry} &\textbf{Comment}\\\hline
  \rule{0pt}{1.05em}\verb|\index{hello}| &hello, 1 &Plain entry\\
\verb|\index{hello!Peter}|   &\hspace*{2ex}Peter, 3 &Subentry under `hello'\\
\verb|\index{Sam@\textsl{Sam}}|     &\textsl{Sam}, 2& Formatted entry\\
\verb|\index{Lin@\textbf{Lin}}|     &\textbf{Lin}, 7& Formatted entry\\
\verb|\index{Kaese@K\"ase}|     &\textbf{K\"ase}, 33& Formatted entry\\
\verb.\index{ecole@\'ecole}.     &\'ecole, 4& Formatted entry\\
\verb.\index{Jenny|textbf}.     &Jenny, \textbf{3}& Formatted page number\\
\verb.\index{Joe|textit}.     &Joe, \textit{5}& Formatted page number
\end{tabular}
\end{center}
\end{table}

\LaTeX 在编译输入文件（\texttt{.tex} 文件）时，每一个 \mintinline{LaTeX}{\index} 命令都会把相应的索引项和当前页码写入和输入文件同名的
\texttt{.idx} 文件。\texttt{makeindex} 程序会对 \texttt{.idx} 文件进行处理，生成 \texttt{.ind} 文件。当再次
编译输入文件时，遇到 \mintinline{LaTeX}{\printindex} 命令时会在文档中输出索引。

\LaTeXe{} 中的 \texttt{showidx} 宏包将所有的索引项打印在相应的文本左侧，这在验证索引时十分有用。

\section{自定义页眉页脚（Headers and Footers）}
Piet van Oostrm 写的 \texttt{fancyhdr} 宏包提供了一些简单的命令，允许用户自定义文档的页眉页脚。

\texttt{fancyhdr} 宏包改善了页眉页脚的定义方式，允许我们将内容自由安置在页眉和页脚的左、中、右三个位置，还为页眉和
页脚各加了一条横线。

\texttt{fancyhdr} 自定义了样式名称 fancy，使用 \texttt{fancyhdr} 宏包定义页眉页脚之前，通常先用
\mintinline{LaTeX}|\pagestyle{fancy}| 调用这个样式。在 \texttt{fancyhdr} 中定义页眉页脚的命令为：
\begin{minted}{LaTeX}
    \fancyhead[position]{...}
    \fancyfoot[position]{...}
\end{minted}

其中 \emph{position} 参数为 \texttt{L}（左）/ \texttt{C}（中）/ \texttt{R}（右）以及与 \texttt{O}（奇数页）
/ \texttt{E}（偶数页）字母的组合。

下面是使用 \texttt{fancyhdr} 的一个示例。它的效果为将章节标题放在和 headings 一致的位置，但使用加粗格式；页码都放
在页脚正中；修改横线宽度，“去掉”页脚的横线。

示例代码：
\begin{minted}{LaTeX}
    % 导言区部分
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    \renewcommand{\chaptermark}[1]{\markboth{#1}{}}
    \renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
    \fancyhf{} % 清空当前的页眉页脚
    \fancyfoot[C]{\bfseries\thepage}
    \fancyhead[LO]{\bfseries\rightmark}
    \fancyhead[RE]{\bfseries\leftmark}
    \renewcommand{\headrulewidth}{0.4pt} % 注意不用 \setlength
    \renewcommand{\footrulewidth}{0pt}
\end{minted}

\section{Verbatim 宏包}
前面我们已经接触过了 \texttt{verbatim} 环境，\texttt{verbatim} 宏包是在 \texttt{verbatim} 红包的基础上重新
实现的，摆脱了原来的一些限制。

\texttt{verbatim} 宏包提供了 \mintinline{LaTeX}|\verbatiminput{filename}| 命令，允许我们将纯 ASCII 码文件
以 \texttt{verbatim} 环境的样式插入文档。

\texttt{verbatim} 宏包属于“tools”宏集，所以大多数系统都已经预装了。

\section{安装额外的宏包}
大多数 \LaTeX 发行版都已经预装了大量的样式宏包，但网上有更多，可以在 CTAN \footnote{http://www.ctan.org/} 找
到。

像 \texttt{geometry}、\texttt{hyphenat} 以及其他很多宏包，都由两个文件组成：\texttt{.ins} 文件和
\texttt{.dtx} 文件。有时会附加一个 \texttt{readme.txt} 文件，包含了对宏包的简要说明。

将宏包文件下载到计算机以后，需要执行以下步骤，一方面告诉 \LaTeX 发行版我们安装了新宏包，另一方面获得宏包的文档：
\begin{enumerate}
    \item 运行 \texttt{.ins} 文件，这会提取出 \texttt{.sty} 文件。
    \item 将 \texttt{.sty} 文件移动到 \LaTeX 发行版可以找到的地方。通常是 \texttt{.../localtexmf/tex/latex}
    的子目录。
    \item 刷新 \LaTeX 发行版的文件名数据库。不同的 \LaTeX 发行版对应的命令有所不同：\TeX Live -
    \mintinline{bash}{texhash}；web2c - \mintinline{bash}{maktexlsr}；MiK\TeX{} -
    \mintinline{bash}{inittexmf --update-fndb}。
\end{enumerate}

现在从 \texttt{.dtx} 文件中提取文档：
\begin{enumerate}
    \item 运行 \texttt{.dtx} 文件，会生成一个 \texttt{.dvi} 文件。注意，可能需要编译多次才能保证交叉引用正确。
    \item 检查是否产生了 \texttt{.idx} 文件。如果产生了该文件，继续执行下面的步骤；否则，说明文档没有索引，跳转到
    步骤~\ref{item:make_pdf}。
    \item 执行 \mintinline{bash}{makeindex -s gind.ist name} 命令以产生索引。其中的 \emph{name} 参数是不
    包含扩展名的主文件名。
    \item \label{item:run_dtx_again} 再次运行 \texttt{.dtx} 文件。
    \item \label{item:make_pdf} 通过 \texttt{.dvi} 文件生成 \texttt{.ps} 或者 \texttt{.pdf} 文件进行阅读。
\end{enumerate}

有时候会看到一个 \texttt{.glo} （glossary）文件，这时需要在步骤~\ref{item:run_dtx_again} 和
步骤~\ref{item:make_pdf} 之间执行 \\ \mintinline{LaTeX}{makeindex -s gglo.ist name.gls name.glo}。还要
确保在执行步骤~\ref{item:make_pdf} 之前再运行一遍 \texttt{.dtx} 文件。

\end{document}
